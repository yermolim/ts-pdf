/**
 * Copyright 2021 yermolim
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * 
 * FlateStream class is based on the corresponding one from PDF.js,
 * so the code of that class is also subject to the next license notice:
 * 
 * Copyright 2012 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Copyright 1996-2003 Glyph & Cog, LLC
 * 
 * The flate stream implementation contained in this file is a JavaScript port
 * of XPDF's implementation, made available under the Apache 2.0 open source
 * license.
 */

import{renderTextLayer as e,RenderingCancelledException as t,GlobalWorkerOptions as n,getDocument as r}from"pdfjs-dist";function i(e,t,n){return Math.max(t,Math.min(e,n))}function s(e,t,n,r){return Math.hypot(n-e,r-t)}function a(e){if(!(null==e?void 0:e.length))return 0;if(1===e.length)return e[0];const t=Array.from(e,(e=>("0"+(255&e).toString(16)).slice(-2))).join("");return parseInt(t,16)}var o=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{l(r.next(e))}catch(e){s(e)}}function o(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};class l{constructor(e){if(this.onMouseDown=e=>{var t;this._divModeTimer&&(clearTimeout(this._divModeTimer),this._divModeTimer=null),null===(t=this._renderTask)||void 0===t||t.expandTextDivs(!0)},this.onMouseUp=e=>{this._divModeTimer=setTimeout((()=>{var e;null===(e=this._renderTask)||void 0===e||e.expandTextDivs(!1),this._divModeTimer=null}),300)},!e)throw new Error("Page proxy is not defined");this._pageProxy=e,this._container=document.createElement("div"),this._container.classList.add("page-text"),this._container.addEventListener("mousedown",this.onMouseDown),this._container.addEventListener("mouseup",this.onMouseUp)}static appendPageTextAsync(e,t,n){return o(this,void 0,void 0,(function*(){const r=new l(e);return yield r.renderTextLayerAsync(n),t.append(r._container),r}))}destroy(){this.destroyRenderTask(),this._container&&(this._container.remove(),this._container=null)}renderTextLayerAsync(t){return o(this,void 0,void 0,(function*(){this.clear(),this.destroyRenderTask();const n=this._pageProxy.getViewport({scale:t}),r=this._pageProxy.streamTextContent();this._renderTask=e({container:this._container,textContentStream:r,viewport:n,enhanceTextSelection:!0});try{yield this._renderTask.promise}catch(e){if("TextLayer task cancelled."===e.message)return!1;throw e}return!0}))}clear(){this._container.innerHTML=""}destroyRenderTask(){this._renderTask&&(this._renderTask.cancel(),this._renderTask=null)}}var d=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{l(r.next(e))}catch(e){s(e)}}function o(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};class c{constructor(e,t,n){if(!e)throw new Error("Page proxy is not defined");this._pageProxy=e,this._viewport=e.getViewport({scale:1}),this._maxScale=Math.max(t,1);const{width:r,height:i}=this._viewport,s=(n=Math.max(null!=n?n:0,50))*(i/r);this._dimensions={width:r,height:i,previewWidth:n,previewHeight:s},this._previewContainer=document.createElement("div"),this._previewContainer.classList.add("page-preview"),this._previewContainer.setAttribute("data-page-number",e.pageNumber+""),this._previewContainer.style.width=this._dimensions.previewWidth+"px",this._previewContainer.style.height=this._dimensions.previewHeight+"px",this._viewContainer=document.createElement("div"),this._viewContainer.classList.add("page"),this._viewContainer.setAttribute("data-page-number",e.pageNumber+""),this.scale=1}get previewContainer(){return this._previewContainer}get viewContainer(){return this._viewContainer}set _viewRendered(e){this.$viewRendered=e,this._viewContainer.setAttribute("data-loaded",e+"")}get _viewRendered(){return this.$viewRendered}set scale(e){if(e<=0||this._scale===e)return;this._scale=e;const t=window.devicePixelRatio;this._dimensions.scaledWidth=this._dimensions.width*this._scale,this._dimensions.scaledHeight=this._dimensions.height*this._scale,this._dimensions.scaledDprWidth=this._dimensions.scaledWidth*t,this._dimensions.scaledDprHeight=this._dimensions.scaledHeight*t,this._viewContainer.style.width=this._dimensions.scaledWidth+"px",this._viewContainer.style.height=this._dimensions.scaledHeight+"px",this._viewCanvas&&(this._viewCanvas.style.width=this._dimensions.scaledWidth+"px",this._viewCanvas.style.height=this._dimensions.scaledHeight+"px"),this._scaleIsValid=!1}get viewValid(){return this._scaleIsValid&&this._viewRendered}destroy(){this._previewContainer.remove(),this._viewContainer.remove(),this._pageProxy.cleanup()}renderPreviewAsync(e=!1){return d(this,void 0,void 0,(function*(){if(this._renderPromise&&(e&&this.cancelRenderTask(),yield this._renderPromise),e||!this._previewRendered)return this._renderPromise=this.runPreviewRenderAsync(),this._renderPromise}))}renderViewAsync(e=!1){return d(this,void 0,void 0,(function*(){if(this._renderPromise&&(e&&this.cancelRenderTask(),yield this._renderPromise),e||!this.viewValid)return this._renderPromise=this.runViewRenderAsync(),this._renderPromise}))}clearPreview(){this._previewContainer.innerHTML=""}clearView(){var e,t;null===(e=this._text)||void 0===e||e.destroy(),null===(t=this._viewCanvas)||void 0===t||t.remove(),this._viewRendered=!1}cancelRenderTask(){this._renderTask&&(this._renderTask.cancel(),this._renderTask=null)}runRenderTaskAsync(e){return d(this,void 0,void 0,(function*(){this.cancelRenderTask(),this._renderTask=this._pageProxy.render(e);try{yield this._renderTask.promise}catch(e){if(e instanceof t)return!1;throw e}finally{this._renderTask=null}return!0}))}createPreviewCanvas(){const e=document.createElement("canvas");e.classList.add("page-canvas");const t=window.devicePixelRatio,{previewWidth:n,previewHeight:r}=this._dimensions;return e.style.width=n+"px",e.style.height=r+"px",e.width=n*t,e.height=r*t,e}createViewCanvas(){const e=document.createElement("canvas");return e.classList.add("page-canvas"),e.style.width=this._dimensions.scaledWidth+"px",e.style.height=this._dimensions.scaledHeight+"px",e.width=this._dimensions.scaledDprWidth,e.height=this._dimensions.scaledDprHeight,e}scaleCanvasImage(e,t){let n,r=this._scale/this._maxScale,i=e;for(;r<.5;)n=document.createElement("canvas"),n.width=.5*i.width,n.height=.5*i.height,n.getContext("2d").drawImage(i,0,0,n.width,n.height),i=n,r*=2;t.getContext("2d").drawImage(i,0,0,t.width,t.height)}runPreviewRenderAsync(){return d(this,void 0,void 0,(function*(){const e=this.createPreviewCanvas(),t={canvasContext:e.getContext("2d"),viewport:this._viewport.clone({scale:e.width/this._dimensions.width})};(yield this.runRenderTaskAsync(t))?(this._previewContainer.innerHTML="",this._previewContainer.append(e),this._previewRendered=!0):this._previewRendered=!1}))}runViewRenderAsync(){var e,t;return d(this,void 0,void 0,(function*(){const n=this._scale;null===(e=this._text)||void 0===e||e.destroy();const r=this.createViewCanvas(),i={canvasContext:r.getContext("2d"),viewport:this._viewport.clone({scale:n*window.devicePixelRatio}),enableWebGL:!0};(yield this.runRenderTaskAsync(i))&&n===this._scale&&(null===(t=this._viewCanvas)||void 0===t||t.remove(),this._viewContainer.append(r),this._viewCanvas=r,this._viewRendered=!0,this._text=yield l.appendPageTextAsync(this._pageProxy,this._viewContainer,n),n===this._scale&&(this._scaleIsValid=!0))}))}}const h=0,u=8,p=9,f=10,g=12,A=13,w=32,v=37,m=40,y=41,b=45,x=46,C=47,S=48,E=49,P=50,B=51,I=52,_=53,k=54,D=55,N=56,T=57,R=60,L=62,M=80,V=82,U=83,O=88,Q=91,H=92,W=93,j=97,X=98,q=100,Y=101,K=102,J=106,F=108,G=109,z=110,Z=111,$=112,ee=114,te=115,ne=116,re=117,ie=120,se=121,ae={NULL:[z,re,F,F],OBJ:[Z,X,J],OBJ_END:[Y,z,q,Z,X,J],STREAM_START:[te,ne,ee,Y,j,G],STREAM_END:[Y,z,q,te,ne,ee,Y,j,G],DICT_START:[R,R],DICT_END:[L,L],ARRAY_START:[Q],ARRAY_END:[W],STR_LITERAL_START:[m],STR_LITERAL_END:[y],STR_HEX_START:[R],STR_HEX_END:[L],VERSION:[v,M,68,70,b],PREV:[C,M,ee,Y,118],TYPE:[C,84,se,$,Y],SUBTYPE:[C,U,re,X,ne,se,$,Y],XREF_TABLE:[ie,ee,Y,K],XREF_STREAM:[C,O,V,Y,K],XREF_HYBRID:[O,V,Y,K,U,ne,G],XREF_START:[te,ne,j,ee,ne,ie,ee,Y,K],TRAILER:[ne,ee,j,105,F,Y,ee],END_OF_FILE:[v,v,Y,Z,K],END_OF_LINE:[A,f]},oe=new Set([v,m,y,C,R,L,Q,W,123,125]),le=new Set([h,p,f,g,A,w]),de=new Set([S,E,P,B,I,_,k,D,N,T]);function ce(e){return!oe.has(e)&&!le.has(e)}const he=3,ue=4,pe=7,fe=8,ge=0,Ae=1,we=0,ve=1,me=2,ye=1,be=2,xe=10,Ce=11,Se=12,Ee=13,Pe=14,Be=15,Ie="/XRef",_e="/ObjStm",ke="/XRef",De="/Catalog",Ne="/Pages",Te="/Page",Re="",Le=0,Me=2,Ve=3,Ue=4,Oe=5,Qe=6,He=7,We=8,je=9,Xe=10,qe=11,Ye=new Set(["/FlateDecode"]);class Ke{constructor(e,t){this.id=null!=e?e:0,this.generation=null!=t?t:0,this.reused=this.generation>0}static parse(e,t,n=!0){if(n&&(t=e.findRegularIndex("straight",t)),t<0||t>e.maxIndex)return null;const r=e.parseNumberAt(t,!1,!1);if(!r||isNaN(r.value))return null;const i=e.parseNumberAt(r.end+2,!1,!1);return!i||isNaN(i.value)?null:{value:new Ke(r.value,i.value),start:t,end:i.end}}static parseRef(e,t,n=!0){const r=Ke.parse(e,t,n);if(!r)return null;const i=r.end+2,s=e.findSubarrayIndex([V],{minIndex:i,closedOnly:!0});return s&&s.start===i?{value:r.value,start:r.start,end:s.end}:null}static parseRefArray(e,t,n=!0){const r=e.getArrayBoundsAt(t,n);if(!r)return null;const i=[];let s,a=r.start+1;for(;a<r.end&&(s=Ke.parseRef(e,a,!0),s);)i.push(s.value),a=s.end+1;return{value:i,start:r.start,end:r.end}}equals(e){return this.id===e.id&&this.generation===e.generation}toObjArray(){return(new TextEncoder).encode(`${this.id} ${this.generation} obj`)}toRefArray(){return(new TextEncoder).encode(`${this.id} ${this.generation} R`)}toString(){return this.id+"|"+this.generation}}class Je extends class{constructor(e){this._minBufferLength=512,this._bufferLength=0,this._current=0,this._ended=!1,this._sourceStream=e}get length(){return this._buffer.length}ensureBuffer(e){const t=this._buffer;if(t&&e<=t.byteLength)return t;let n=this._minBufferLength;for(;n<e;)n*=2;const r=new Uint8Array(n);return t&&r.set(t),this._buffer=r}takeByte(){const e=this._current;for(;this._bufferLength<=e;){if(this._ended)return-1;this._readBlock()}return this._buffer[this._current++]}takeBytes(e){let t;const n=this._current;if(e){for(this.ensureBuffer(n+e),t=n+e;!this._ended&&this._bufferLength<t;)this._readBlock();t>this._bufferLength&&(t=this._bufferLength)}else{for(;!this._ended;)this._readBlock();t=this._bufferLength}this._current=t;return this._buffer.subarray(n,t)}takeUint16(){const e=this.takeByte(),t=this.takeByte();return-1===e||-1===t?-1:(e<<8)+t}takeInt32(){return(this.takeByte()<<24)+(this.takeByte()<<16)+(this.takeByte()<<8)+this.takeByte()}peekByte(){const e=this.takeByte();return-1!==e&&this._current--,e}peekBytes(e){const t=this.takeBytes(e);return this._current-=t.length,t}skip(e){this._current+=e||1}reset(){this._current=0}}{constructor(e){super(e),this._codeSize=0,this._codeBuf=0;const t=e.takeByte(),n=e.takeByte();if(-1===t||-1===n)throw new Error(`Invalid header in flate stream: ${t}, ${n}`);if(8!=(15&t))throw new Error(`Unknown compression method in flate stream: ${t}, ${n}`);if(((t<<8)+n)%31!=0)throw new Error(`Bad FCHECK in flate stream: ${t}, ${n}`);if(32&n)throw new Error(`FDICT bit set in flate stream: ${t}, ${n}`);this._codeSize=0,this._codeBuf=0}_readBlock(){let e,t;const n=this._sourceStream;let r,i,s=this.getBits(3);if(1&s&&(this._ended=!0),s>>=1,0===s){let t;if(-1===(t=n.takeByte()))throw new Error("Bad block header in flate stream");let r=t;if(-1===(t=n.takeByte()))throw new Error("Bad block header in flate stream");if(r|=t<<8,-1===(t=n.takeByte()))throw new Error("Bad block header in flate stream");let i=t;if(-1===(t=n.takeByte()))throw new Error("Bad block header in flate stream");if(i|=t<<8,i!==(65535&~r)&&(0!==r||0!==i))throw new Error("Bad uncompressed block length in flate stream");this._codeBuf=0,this._codeSize=0;const s=this._bufferLength,a=s+r;if(e=this.ensureBuffer(a),this._bufferLength=a,0===r)-1===n.peekByte()&&(this._ended=!0);else{const t=n.takeBytes(r);e.set(t,s),t.length<r&&(this._ended=!0)}return}if(1===s)r=Je.fixedLitCodeTab,i=Je.fixedDistCodeTab;else{if(2!==s)throw new Error("Unknown block type in flate stream");{const e=this.getBits(5)+257,n=this.getBits(5)+1,s=this.getBits(4)+4,a=new Uint8Array(Je.codeLenCodeMap.length);let o;for(o=0;o<s;o++)a[Je.codeLenCodeMap[o]]=this.getBits(3);const l=this.generateHuffmanTable(a);t=0,o=0;const d=e+n,c=new Uint8Array(d);let h,u,p;for(;o<d;){const e=this.getCode(l);if(16===e)h=2,u=3,p=t;else if(17===e)h=3,u=3,p=t=0;else{if(18!==e){c[o++]=t=e;continue}h=7,u=11,p=t=0}let n=this.getBits(h)+u;for(;n-- >0;)c[o++]=p}r=this.generateHuffmanTable(c.subarray(0,e)),i=this.generateHuffmanTable(c.subarray(e,d))}}e=this._buffer;let a=e?e.length:0,o=this._bufferLength;for(;;){let n=this.getCode(r);if(n<256){o+1>=a&&(e=this.ensureBuffer(o+1),a=e.length),e[o++]=n;continue}if(256===n)return void(this._bufferLength=o);n-=257,n=Je.lengthDecode[n];let s=n>>16;s>0&&(s=this.getBits(s)),t=(65535&n)+s,n=this.getCode(i),n=Je.distDecode[n],s=n>>16,s>0&&(s=this.getBits(s));const l=(65535&n)+s;o+t>=a&&(e=this.ensureBuffer(o+t),a=e.length);for(let n=0;n<t;++n,++o)e[o]=e[o-l]}}getBits(e){const t=this._sourceStream;let n,r=this._codeSize,i=this._codeBuf;for(;r<e;){if(-1===(n=t.takeByte()))throw new Error("Bad encoding in flate stream");i|=n<<r,r+=8}return n=i&(1<<e)-1,this._codeBuf=i>>e,this._codeSize=r-=e,n}getCode(e){const t=this._sourceStream,[n,r]=e;let i,s=this._codeSize,a=this._codeBuf;for(;s<r&&-1!==(i=t.takeByte());)a|=i<<s,s+=8;const o=n[a&(1<<r)-1],l=o>>16,d=65535&o;if(l<1||s<l)throw new Error("Bad encoding in flate stream");return this._codeBuf=a>>l,this._codeSize=s-l,d}generateHuffmanTable(e){const t=e.length;let n,r=0;for(n=0;n<t;n++)e[n]>r&&(r=e[n]);const i=1<<r,s=new Int32Array(i);for(let a=1,o=0,l=2;a<=r;a++,o<<=1,l<<=1)for(let r=0;r<t;r++)if(e[r]===a){let e=0,t=o;for(n=0;n<a;n++)e=e<<1|1&t,t>>=1;for(n=e;n<i;n+=l)s[n]=a<<16|r;o++}return[s,r]}}Je.codeLenCodeMap=new Int32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Je.lengthDecode=new Int32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),Je.distDecode=new Int32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),Je.fixedLitCodeTab=[new Int32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],Je.fixedDistCodeTab=[new Int32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];class Fe{constructor(e,t=0,n){if(n&&n<0)throw new Error("Stream length can't be negative");this._bytes=e instanceof Uint8Array?e:new Uint8Array(e),this._start=t,this._current=t,this._end=t+n||e.length}get length(){return this._end-this._start}takeByte(){return this._current>=this._end?-1:this._bytes[this._current++]}takeBytes(e){const t=this._bytes,n=this._current,r=this._end;if(e){let i=n+e;i>r&&(i=r),this._current=i;return t.subarray(n,i)}return t.subarray(n,r)}takeUint16(){const e=this.takeByte(),t=this.takeByte();return-1===e||-1===t?-1:(e<<8)+t}takeInt32(){return(this.takeByte()<<24)+(this.takeByte()<<16)+(this.takeByte()<<8)+this.takeByte()}peekByte(){const e=this.takeByte();return-1!==e&&this._current--,e}peekBytes(e){const t=this.takeBytes(e);return this._current-=t.length,t}getByte(e){return this._bytes[e]}getByteRange(e,t){return this._bytes.subarray(Math.max(e,0),Math.min(t,this._end))}skip(e){this._current+=e||1}reset(){this._current=this._start}}class Ge{static Decode(e,t=ye,n=1,r=1,i=8){const s=new Fe(e,0,e.length),a=new Je(s).takeBytes(null);switch(t){case ye:return a;case xe:case Ce:case Se:case Ee:case Pe:case Be:return Ge.removePngFilter(a,n,r,i);case be:throw new Error("Unsupported filter predictor")}}static Encode(e){return null}static removePngFilter(e,t,n,r){const i=Math.ceil(n*r/8),s=t*i,a=s+1;if(e.length%a)throw new Error("Data length doesn't match filter columns");const o=new Uint8Array(e.length/a*s),l=new Array(s).fill(0),d=new Array(s).fill(0),c=e=>e-i<0?0:d[e-i],h=e=>l[e];let u=0,p=0,f=0,g=0,A=0,w=0;for(let t=0;t<e.length;t++)if(t%a==0){if(A=e[t],u=0,t)for(f=0;f<s;f++)l[f]=o[g+f];g=p}else{switch(d[u]=e[t],A){case 0:w=d[u];break;case 1:w=(d[u]+c(u))%256;break;case 2:w=(d[u]+h(u))%256;break;case 3:w=(d[u]+Math.floor((h(u)+c(u))/2))%256;break;case 4:w=(d[u]+this.paethPredictor(c(u),h(u),(v=u)-i<0?0:l[v-i]))%256}o[p++]=w,u++}var v;return o}static applyPngFilter(e,t,n){return null}static paethPredictor(e,t,n){const r=e+t-n,i=Math.abs(r-e),s=Math.abs(r-t),a=Math.abs(r-n);return i<=s&&i<=a?e:s<=a?t:n}}class ze{constructor(e){if(!(null==e?void 0:e.length))throw new Error("Data is empty");this._data=e,this._maxIndex=e.length-1}get maxIndex(){return this._maxIndex}getPdfVersion(){var e;const t=this.findSubarrayIndex(ae.VERSION);if(!t)throw new Error("PDF not valid. Version not found");const n=null===(e=this.parseNumberAt(t.end+1,!0))||void 0===e?void 0:e.value;if(!n)throw new Error("Error parsing version number");return n.toFixed(1)}getLastXrefIndex(){const e=this.findSubarrayIndex(ae.XREF_START,{maxIndex:this.maxIndex,direction:"reverse"});if(!e)return null;const t=this.parseNumberAt(e.end+1);return t||null}findSubarrayIndex(e,t){var n,r;const i=this._data;if(!(null==e?void 0:e.length))return null;const s=(null==t?void 0:t.direction)||"straight",a=Math.max(Math.min(null!==(n=null==t?void 0:t.minIndex)&&void 0!==n?n:0,this._maxIndex),0),o=Math.max(Math.min(null!==(r=null==t?void 0:t.maxIndex)&&void 0!==r?r:this._maxIndex,this._maxIndex),0),l=!(null==t?void 0:t.closedOnly);let d,c="straight"===s?a:o;if("straight"===s)e:for(;c<=o;c++){for(d=0;d<e.length;d++)if(i[c+d]!==e[d])continue e;if(l||!ce(i[c+d]))return{start:c,end:c+d-1}}else{const t=e.length-1;e:for(;c>=a;c--){for(d=0;d<e.length;d++)if(i[c-d]!==e[t-d])continue e;if(l||!ce(i[c-d]))return{start:c-d+1,end:c}}}return null}findCharIndex(e,t="straight",n){return this.findSingleCharIndex((t=>e===t),t,n)}findNewLineIndex(e="straight",t){let n=this.findSingleCharIndex((e=>e===A||e===f),e,t);return-1===n?-1:"straight"===e?(this._data[n]===A&&this._data[n+1]===f&&n++,Math.min(n+1,this._maxIndex)):(this._data[n]===f&&this._data[n-1]===A&&n--,Math.max(n-1,0))}findSpaceIndex(e="straight",t){return this.findSingleCharIndex((e=>le.has(e)),e,t)}findNonSpaceIndex(e="straight",t){return this.findSingleCharIndex((e=>!le.has(e)),e,t)}findDelimiterIndex(e="straight",t){return this.findSingleCharIndex((e=>oe.has(e)),e,t)}findNonDelimiterIndex(e="straight",t){return this.findSingleCharIndex((e=>!oe.has(e)),e,t)}findIrregularIndex(e="straight",t){return this.findSingleCharIndex((e=>!ce(e)),e,t)}findRegularIndex(e="straight",t){return this.findSingleCharIndex((e=>ce(e)),e,t)}getValueTypeAt(e,t=!0){if(t&&(e=this.skipEmpty(e)),this.isOutside(e))return null;const n=this._data,r=e;switch(n[r]){case C:return ce(n[r+1])?Qe:Le;case Q:return He;case m:return Ue;case R:return R===n[r+1]?We:Oe;case v:return qe;case S:case E:case P:case B:case I:case _:case k:case D:case N:case T:const e=this.findDelimiterIndex("straight",r+1);if(-1!==e){const t=this.findCharIndex(V,"reverse",e-1);if(-1!==t&&t>r)return Xe}return Ve;case te:return n[r+1]===ne&&n[r+2]===ee&&n[r+3]===Y&&n[r+4]===j&&n[r+5]===G?je:Le;case ne:return n[r+1]===ee&&n[r+2]===re&&n[r+3]===Y?Me:Le;case K:return n[r+1]===j&&n[r+2]===F&&n[r+3]===te&&n[r+4]===Y?Me:Le;default:return Le}}getIndirectObjectBoundsAt(e,t=!0){if(t&&(e=this.skipEmpty(e)),this.isOutside(e))return null;const n=this.findSubarrayIndex(ae.OBJ,{minIndex:e,closedOnly:!0});if(!n)return null;const r=this.findNonSpaceIndex("straight",n.end+1);if(-1===r)return null;const i=this.findSubarrayIndex(ae.OBJ_END,{minIndex:r,closedOnly:!0});if(!i)return null;const s=this.findNonSpaceIndex("reverse",i.start-1);return{start:n.start,end:i.end,contentStart:r,contentEnd:s}}getXrefTableBoundsAt(e,t=!0){if(t&&(e=this.skipEmpty(e)),this.isOutside(e)||this._data[e]!==ie)return null;const n=this.findSubarrayIndex(ae.XREF_TABLE,{minIndex:e});if(!n)return null;const r=this.findNonSpaceIndex("straight",n.end+1);if(-1===r)return null;const i=this.findSubarrayIndex(ae.TRAILER,{minIndex:n.end+1});if(!i)return null;const s=this.findNonSpaceIndex("reverse",i.start-1);return s<r?null:{start:n.start,end:i.end,contentStart:r,contentEnd:s}}getDictBoundsAt(e,t=!0){if(t&&(e=this.skipEmpty(e)),this.isOutside(e)||this._data[e]!==R)return null;const n=this.findSubarrayIndex(ae.DICT_START,{minIndex:e});if(!n)return null;const r=this.findNonSpaceIndex("straight",n.end+1);if(-1===r)return null;let i,s,a=0,o=0,l=r;for(;;)if(s=i,i=this._data[l++],i!==m||o&&s===H||o++,i===y&&o&&s!==H&&o--,!o&&(i===R&&i===s&&a++,i===L&&i===s)){if(!a)break;a--}const d=l-1,c=this.findNonSpaceIndex("reverse",d-2);return c<r?null:{start:n.start,end:d,contentStart:r,contentEnd:c}}getArrayBoundsAt(e,t=!0){if(t&&(e=this.skipEmpty(e)),this.isOutside(e)||this._data[e]!==Q)return null;let n,r=0,i=e+1;for(;r||n!==W;)n=this._data[i++],n===Q?r++:r&&n===W&&r--;const s=i-1;return s-e<2?null:{start:e,end:s}}parseNumberAt(e,t=!1,n=!0){if(n&&(e=this.skipEmpty(e)),this.isOutside(e)||!ce(this._data[e]))return null;let r=e,i="",s=this._data[r];for(s===b&&(i+=s,s=this._data[++r]);de.has(s)||t&&s===x;)i+=String.fromCharCode(s),s=this._data[++r];return i?{value:+i,start:e,end:r-1}:null}parseNameAt(e,t=!0,n=!0){if(n&&(e=this.skipEmpty(e)),this.isOutside(e)||this._data[e]!==C)return null;let r=e+1,i=t?"/":"",s=this._data[r];for(;ce(s);)i+=String.fromCharCode(s),s=this._data[++r];return i.length>1?{value:i,start:e,end:r-1}:null}parseNumberArrayAt(e,t=!0,n=!0){const r=this.getArrayBoundsAt(e,n);if(!r)return null;const i=[];let s,a=r.start+1;for(;a<r.end&&(s=this.parseNumberAt(a,t,!0),s);)i.push(s.value),a=s.end+1;return{value:i,start:r.start,end:r.end}}parseNameArrayAt(e,t=!0,n=!0){const r=this.getArrayBoundsAt(e,n);if(!r)return null;const i=[];let s,a=r.start+1;for(;a<r.end&&(s=this.parseNameAt(a,t,!0),s);)i.push(s.value),a=s.end+1;return{value:i,start:r.start,end:r.end}}parseDictType(e){return this.parseDictNameProperty(ae.TYPE,e)}parseDictSubtype(e){return this.parseDictNameProperty(ae.SUBTYPE,e)}parseDictNameProperty(e,t){const n=this.findSubarrayIndex(e,{minIndex:t.start,maxIndex:t.end});if(!n)return null;const r=this.parseNameAt(n.end+1);return r?r.value:null}skipEmpty(e){let t=this.findNonSpaceIndex("straight",e);if(-1===t)return-1;if(this._data[t]===v){const e=this.findNewLineIndex("straight",t+1);if(-1===e)return-1;t=this.findNonSpaceIndex("straight",e)}return t}skipToNextName(e,t){if(e||(e=0),(t=t?Math.min(t,this._maxIndex):0)<e)return-1;for(let n=e;n<=t;n++)if(this._data[n]===C)return n;return-1}getCharCode(e){return this._data[e]}getChar(e){const t=this._data[e];return isNaN(t)?null:String.fromCharCode(t)}sliceCharCodes(e,t){return this._data.slice(e,(t||e)+1)}sliceChars(e,t){return String.fromCharCode(...this._data.slice(e,(t||e)+1))}subCharCodes(e,t){return this._data.subarray(e,(t||e)+1)}isOutside(e){return e<0||e>this._maxIndex}getValidStartIndex(e,t){return isNaN(t)?"straight"===e?0:this._maxIndex:Math.max(Math.min(t,this._maxIndex),0)}findSingleCharIndex(e,t="straight",n){const r=this._data;let i=this.getValidStartIndex(t,n);if("straight"===t){for(;i<=this._maxIndex;i++)if(e(r[i]))return i}else for(;i>=0;i--)if(e(r[i]))return i;return-1}}class Ze{constructor(e,t,n){this.literal=e,this.hex=t,this.bytes=n}static parse(e,t,n=!0){if(n&&(t=e.skipEmpty(t)),e.isOutside(t)||e.getCharCode(t)!==R)return null;const r=e.findCharIndex(L,"straight",t+1);if(-1===r)return;return{value:Ze.fromBytes(e.sliceCharCodes(t,r)),start:t,end:r}}static parseArray(e,t,n=!0){const r=e.getArrayBoundsAt(t,n);if(!r)return null;const i=[];let s,a=r.start+1;for(;a<r.end&&(s=Ze.parse(e,a,!0),s);)i.push(s.value),a=s.end+1;return{value:i,start:r.start,end:r.end}}static fromBytes(e){const t=(new TextDecoder).decode(e),n=Array.from(e,((e,n)=>("0"+t.charCodeAt(n).toString(16)).slice(-2))).join("");return new Ze(t,n,e)}static fromHexString(e){const t=(new TextEncoder).encode(e),n=(new TextDecoder).decode(t);return new Ze(n,e,t)}static fromLiteralString(e){const t=Array.from(e,((t,n)=>("000"+e.charCodeAt(n).toString(16)).slice(-4))).join(""),n=(new TextEncoder).encode(t);return new Ze(e,t,n)}toArray(e=!1){return e?new Uint8Array([...ae.STR_HEX_START,...this.bytes,...ae.STR_HEX_END]):new Uint8Array(this.bytes)}}class $e{constructor(e,t){this.literal=e,this.bytes=t}static parse(e,t,n=!0){if(n&&(t=e.skipEmpty(t)),e.isOutside(t)||e.getCharCode(t)!==m)return null;const r=[];let i,s,a=t+1,o=0;for(;o||s!==y||i===H;)s&&(r.push(s),i=s),s=e.getCharCode(a++),i!==H&&(s===m?o+=1:o&&s===y&&(o-=1));if(!r.length)return null;return{value:$e.fromBytes(new Uint8Array(r)),start:t,end:a-1}}static fromBytes(e){const t=(new TextDecoder).decode($e.unescape(e));return new $e(t,e)}static fromString(e){const t=$e.escape((new TextEncoder).encode(e));return new $e(e,t)}static escape(e){const t=[];for(let n=0;n<e.length;n++)switch(e[n]){case f:t.push(H),t.push(z);break;case A:t.push(H),t.push(ee);break;case p:t.push(H),t.push(ne);break;case u:t.push(H),t.push(X);break;case g:t.push(H),t.push(K);break;case m:t.push(H),t.push(m);break;case y:t.push(H),t.push(y);break;case H:t.push(H),t.push(H);break;default:t.push(e[n])}return new Uint8Array(t)}static unescape(e){const t=[];let n=!1;for(let r=0;r<e.length;r++)if(n){switch(e[r]){case z:t.push(f);break;case ee:t.push(A);break;case ne:t.push(p);break;case X:t.push(u);break;case K:t.push(g);break;case m:t.push(m);break;case y:t.push(y);break;case H:t.push(H);break;default:t.push(e[r])}n=!1}else e[r]!==H?t.push(e[r]):n=!0;return new Uint8Array(t)}toArray(e=!1){return e?new Uint8Array([...ae.STR_LITERAL_START,...this.bytes,...ae.STR_LITERAL_END]):new Uint8Array(this.bytes)}}class et{constructor(e){this._customProps=new Map,this.Type=e}get customProps(){return new Map(this._customProps)}tryParseProps(e){if(!e)return!1;const{parser:t,bounds:n}=e,r=n.contentStart||n.start,i=n.contentEnd||n.end;let s,a,o=t.skipToNextName(r,i-1);if(-1===o)return!1;for(;a=t.parseNameAt(o),a;)switch(o=a.end+1,s=a.value,s){case"/Type":const e=t.parseNameAt(o);if(e)return!this.Type||this.Type===e.value;throw new Error("Can't parse /Type property value");default:o=t.skipToNextName(o,i-1)}return!0}}class tt extends et{constructor(){super(Re),this.Predictor=ye,this.Colors=1,this.BitsPerComponent=8,this.Columns=1}static parse(e,t,n){const r=new tt;let i,s,a=t+2;for(;s=e.parseNameAt(a),s;)switch(a=s.end+1,i=s.value,i){case"/Predictor":const t=e.parseNumberAt(a,!1);if(!t)throw new Error("Can't parse /Colors property value");r.Predictor=t.value,a=t.end+1;break;case"/Colors":const i=e.parseNumberAt(a,!1);if(!i)throw new Error("Can't parse /Colors property value");r.Colors=i.value,a=i.end+1;break;case"/BitsPerComponent":const s=e.parseNumberAt(a,!1);if(!s)throw new Error("Can't parse /BitsPerComponent property value");r.BitsPerComponent=s.value,a=s.end+1;break;case"/Columns":const o=e.parseNumberAt(a,!1);if(!o)throw new Error("Can't parse /Columns property value");r.Columns=o.value,a=o.end+1;break;default:a=e.skipToNextName(a,n)}return{value:r,start:t,end:n}}}class nt extends class{constructor(){}}{constructor(e=null){super(),this.Type=e}tryParseProps(e){if(!e)return!1;const{parser:t,bounds:n}=e,r=n.contentStart||n.start,i=n.contentEnd||n.end,s=t.findSubarrayIndex(ae.STREAM_END,{direction:"reverse",minIndex:r,maxIndex:i,closedOnly:!0});if(!s)return!1;const a=t.findSubarrayIndex(ae.STREAM_START,{direction:"reverse",minIndex:r,maxIndex:s.start-1,closedOnly:!0});if(!a)return!1;const o=a.start-1;let l,d,c=t.skipToNextName(r,o);if(-1===c)return!1;for(;d=t.parseNameAt(c),d;)switch(c=d.end+1,l=d.value,l){case"/Type":const e=t.parseNameAt(c);if(!e)throw new Error("Can't parse /Type property value");if(this.Type&&this.Type!==e.value)return!1;c=e.end+1;break;case"/Length":const n=t.parseNumberAt(c,!1);if(!n)throw new Error("Can't parse /Length property value");this.Length=n.value,c=n.end+1;break;case"/Filter":const r=t.getValueTypeAt(c);if(r===Qe){const e=t.parseNameAt(c);if(e&&Ye.has(e.value)){this.Filter=e.value,c=e.end+1;break}throw new Error(`Unsupported /Filter property value: ${e.value}`)}if(r===He){const e=t.parseNameArrayAt(c);if(e){const t=e.value;if(1===t.length&&Ye.has(t[0])){this.Filter=t[0],c=e.end+1;break}throw new Error(`Unsupported /Filter property value: ${t.toString()}`)}}throw new Error(`Unsupported /Filter property value type: ${r}`);case"/DecodeParms":const i=t.getDictBoundsAt(c);if(!i)throw new Error("Can't parse /DecodeParms property value");{const e=tt.parse(t,i.start,i.end);e&&(this.DecodeParms=e.value),c=i.end+1}break;case"/DL":const s=t.parseNumberAt(c,!1);if(!s)throw new Error("Can't parse /DL property value");this.DL=s.value,c=s.end+1;break;default:c=t.skipToNextName(c,o)}const h=t.findNewLineIndex("straight",a.end+1),u=t.findNewLineIndex("reverse",s.start-1),p=t.sliceCharCodes(h,u);if(!this.Length||this.Length!==p.length)throw new Error("Incorrect stream length");return this.streamData=p,!0}}class rt extends nt{constructor(){super(_e)}static parse(e){const t=new rt;return t.tryParseProps(e)?{value:t,start:e.bounds.start,end:e.bounds.end}:null}getObjectData(e){if(!this.streamData||!this.N||!this.First)return null;let t;if(this.DecodeParms){const e=this.DecodeParms;t=Ge.Decode(this.streamData,e.Predictor,e.Columns,e.Colors,e.BitsPerComponent)}else t=Ge.Decode(this.streamData);const n=new ze(t),r=new Map;let i,s,a,o=0;for(let e=0;e<this.N;e++)i=n.parseNumberAt(o,!1,!1),s=i.value,o=i.end+2,i=n.parseNumberAt(o,!1,!1),a=i.value,o=i.end+2,r.set(s,a);if(!r.has(e))return null;const l=this.First+r.get(e),d=n.getValueTypeAt(l);if(null===d)return;let c,h;switch(d){case fe:c=n.getDictBoundsAt(l,!1);break;case pe:c=n.getArrayBoundsAt(l,!1);break;case ue:const e=$e.parse(n,l);e&&(c={start:e.start,end:e.end},h=e);break;case ue:const t=Ze.parse(n,l);t&&(c={start:t.start,end:t.end},h=t);break;case he:const r=n.parseNumberAt(l);r&&(c={start:r.start,end:r.end},h=r)}if(!c)return null;const u=n.sliceCharCodes(c.start,c.end);if(!u.length)throw new Error("Object byte array is empty");return{parser:new ze(u),bounds:{start:0,end:u.length-1},type:d,value:h}}toArray(){return new Uint8Array}tryParseProps(e){if(!super.tryParseProps(e))return!1;if(this.Type!==_e)return!1;const{parser:t,bounds:n}=e,r=n.contentStart||n.start,i=t.getDictBoundsAt(r);let s,a,o=t.skipToNextName(r,i.contentEnd);if(-1===o)return!1;for(;a=t.parseNameAt(o),a;)switch(o=a.end+1,s=a.value,s){case"/N":const e=t.parseNumberAt(o,!1);if(!e)throw new Error("Can't parse /N property value");this.N=e.value,o=e.end+1;break;case"/First":const n=t.parseNumberAt(o,!1);if(!n)throw new Error("Can't parse /First property value");this.First=n.value,o=n.end+1;break;case"/Extends":const r=Ke.parseRef(t,o);if(!r)throw new Error("Can't parse /Extends property value");this.Extends=r.value,o=r.end+1;break;default:o=t.skipToNextName(o,i.contentEnd)}return!0}}class it extends et{constructor(){super(De)}static parse(e){const t=new it;return t.tryParseProps(e)?{value:t,start:e.bounds.start,end:e.bounds.end}:null}tryParseProps(e){if(!super.tryParseProps(e))return!1;const{parser:t,bounds:n}=e,r=n.contentStart||n.start,i=n.contentEnd||n.end;let s,a,o=t.skipToNextName(r,i-1);if(-1===o)return!1;for(;a=t.parseNameAt(o),a;)switch(o=a.end+1,s=a.value,s){case"/Version":const e=t.parseNameAt(o,!1,!1);if(!e)throw new Error("Can't parse /Version property value");this.Version=e.value,o=e.end+1;break;case"/Pages":const n=Ke.parseRef(t,o);if(!n)throw new Error("Can't parse /Pages property value");this.Pages=n.value,o=n.end+1;break;case"/Lang":const r=$e.parse(t,o);if(!r)throw new Error("Can't parse /Lang property value");this.Lang=r.value,o=r.end+1;break;default:o=t.skipToNextName(o,i-1)}return!!this.Pages}}class st{constructor(e,t){this.source=e,this.date=t}static parse(e,t,n=!0){if(n&&(t=e.skipEmpty(t)),e.isOutside(t)||e.getCharCode(t)!==m)return null;const r=e.findCharIndex(y,"straight",t);if(-1===r)return null;try{return{value:st.fromArray(e.subCharCodes(t+1,r-1)),start:t,end:r}}catch(e){return null}}static fromDate(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0"),a=String(e.getSeconds()).padStart(2,"0");return new st(`D:${t}${n}${r}${i}${s}${a}`,e)}static fromString(e){const t=/D:(?<Y>\d{4})(?<M>\d{2})(?<D>\d{2})(?<h>\d{2})(?<m>\d{2})(?<s>\d{2})/.exec(e),n=new Date(+t.groups.Y,+t.groups.M-1,+t.groups.D,+t.groups.h,+t.groups.m,+t.groups.s);return new st(e,n)}static fromArray(e){const t=(new TextDecoder).decode(e);return st.fromString(t)}toArray(){return(new TextEncoder).encode(this.source)}}class at extends et{constructor(){super(Te),this.Rotate=0}static parse(e){const t=new at;return t.tryParseProps(e)?{value:t,start:e.bounds.start,end:e.bounds.end}:null}tryParseProps(e){if(!super.tryParseProps(e))return!1;const{parser:t,bounds:n}=e,r=n.contentStart||n.start,i=n.contentEnd||n.end;let s,a,o=t.skipToNextName(r,i-1);if(-1===o)return!1;for(;a=t.parseNameAt(o),a;)switch(o=a.end+1,s=a.value,s){case"/Parent":const e=Ke.parseRef(t,o);if(!e)throw new Error("Can't parse /Parent property value");this.Parent=e.value,o=e.end+1;break;case"/LastModified":const n=st.parse(t,o,!1);if(!n)throw new Error("Can't parse /LastModified property value");this.LastModified=n.value,o=n.end+1;break;case"/MediaBox":const r=t.parseNumberArrayAt(o,!0);if(!r)throw new Error("Can't parse /MediaBox property value");this.MediaBox=[r.value[0],r.value[1],r.value[2],r.value[3]],o=r.end+1;break;case"/Rotate":const s=t.parseNumberAt(o,!1);if(!s)throw new Error("Can't parse /Rotate property value");this.Rotate=s.value,o=s.end+1;break;case"/Annots":const a=t.getValueTypeAt(o);if(a===Xe){const e=Ke.parseRef(t,o);if(e){this.Annots=e.value,o=e.end+1;break}}else if(a===He){const e=Ke.parseRefArray(t,o);if(e){this.Annots=e.value,o=e.end+1;break}}throw new Error(`Unsupported /Annots property value type: ${a}`);default:o=t.skipToNextName(o,i-1)}return!!this.Parent}}class ot extends et{constructor(){super(Ne),this.Rotate=0}static parse(e){const t=new ot;return t.tryParseProps(e)?{value:t,start:e.bounds.start,end:e.bounds.end}:null}tryParseProps(e){if(!super.tryParseProps(e))return!1;const{parser:t,bounds:n}=e,r=n.contentStart||n.start,i=n.contentEnd||n.end;let s,a,o=t.skipToNextName(r,i-1);if(-1===o)return!1;for(;a=t.parseNameAt(o),a;)switch(o=a.end+1,s=a.value,s){case"/Parent":const e=Ke.parseRef(t,o);if(!e)throw new Error("Can't parse /Parent property value");this.Parent=e.value,o=e.end+1;break;case"/Kids":const n=Ke.parseRefArray(t,o);if(!n)throw new Error("Can't parse /Kids property value");this.Kids=n.value,o=n.end+1;break;case"/Count":const r=t.parseNumberAt(o,!1);if(!r)throw new Error("Can't parse /Count property value");this.Count=r.value,o=r.end+1;break;default:o=t.skipToNextName(o,i-1)}return!(!this.Kids||isNaN(this.Count))}}class lt extends nt{constructor(){super(Ie)}static parse(e){const t=new lt;return t.tryParseProps(e)?{value:t,start:e.bounds.start,end:e.bounds.end}:null}toArray(){return new Uint8Array}tryParseProps(e){var t;if(!super.tryParseProps(e))return!1;if(this.Type!==ke)return!1;const{parser:n,bounds:r}=e,i=r.contentStart||r.start,s=n.getDictBoundsAt(i);let a,o,l=n.skipToNextName(i,s.contentEnd);if(-1===l)return!1;for(;o=n.parseNameAt(l),o;)switch(l=o.end+1,a=o.value,a){case"/Size":const e=n.parseNumberAt(l,!1);if(!e)throw new Error("Can't parse /Size property value");this.Size=e.value,l=e.end+1;break;case"/Prev":const t=n.parseNumberAt(l,!1);if(!t)throw new Error("Can't parse /Size property value");this.Prev=t.value,l=t.end+1;break;case"/Root":const r=Ke.parseRef(n,l);if(!r)throw new Error("Can't parse /Root property value");this.Root=r.value,l=r.end+1;break;case"/Encrypt":const i=Ke.parseRef(n,l);if(!i)throw new Error("Can't parse /Encrypt property value");this.Encrypt=i.value,l=i.end+1;break;case"/Info":const a=Ke.parseRef(n,l);if(!a)throw new Error("Can't parse /Info property value");this.Info=a.value,l=a.end+1;break;case"/ID":const o=Ze.parseArray(n,l);if(!o)throw new Error("Can't parse /ID property value");this.ID=[o.value[0],o.value[1]],l=o.end+1;break;case"/Index":const d=n.parseNumberArrayAt(l);if(!d)throw new Error("Can't parse /Index property value");this.Index=d.value,l=d.end+1;break;case"/W":const c=n.parseNumberArrayAt(l);if(!c)throw new Error("Can't parse /W property value");this.W=[c.value[0],c.value[1],c.value[2]],l=c.end+1;break;default:l=n.skipToNextName(l,s.contentEnd)}return(null===(t=this.Index)||void 0===t?void 0:t.length)||(this.Index=[0,this.Size]),!0}}class dt{constructor(e){this._type=e}get type(){return this._type}}class ct{constructor(e,t,n,r,i,s,a){this.type=e,this.objectId=t,this.generation=n,this.byteOffset=r,this.nextFreeId=i,this.streamId=s,this.streamIndex=a}static*parseFromTable(e){let t=0,n=0;for(;t<e.length;){const r=[];let i=e[t++];for(;de.has(i);)r.push(i),i=e[t++];let s=parseInt(r.map((e=>String.fromCharCode(e))).join(""),10);const a=[];let o=e[t++];for(;de.has(o);)a.push(o),o=e[t++];const l=parseInt(a.map((e=>String.fromCharCode(e))).join(""),10);for(t++,n=0;n<l;n++){const n=parseInt(Array.from(e.slice(t,t+10)).map((e=>String.fromCharCode(e))).join(""),10);t+=11;const r=parseInt(Array.from(e.slice(t,t+5)).map((e=>String.fromCharCode(e))).join(""),10);t+=6;const i=e[t];i===K?yield new ct(we,s++,r,null,n):i===z&&(yield new ct(ve,s++,r,n)),t+=3}}}static*parseFromStream(e,t,n){const[r,i,s]=t,o=r+i+s;if(e.length%o)throw new Error("Incorrect stream length");const l=e.length/o,d=new Array(l).fill(null);if(null==n?void 0:n.length){let e,t,r=0;for(let i=0;i<n.length;i++)if(i%2)for(t=0;t<n[i];t++)d[r++]=e+t;else e=n[i]}let c,h,u,p=0,f=0;for(;p<e.length;)switch(c=r?a(e.slice(p,p+r)):1,p+=r,h=a(e.slice(p,p+i)),p+=i,u=s?a(e.slice(p,p+s)):null,p+=s,c){case we:yield new ct(we,d[f++],null!=u?u:65535,null,h);break;case ve:yield new ct(ve,d[f++],null!=u?u:0,h);break;case me:yield new ct(me,d[f++],0,null,null,h,u)}}toTableBytes(){return null}toStreamBytes(e){return null}}class ht extends dt{constructor(e){super(Ae),this._trailerStream=e}get prev(){var e;return null===(e=this._trailerStream)||void 0===e?void 0:e.Prev}get size(){var e;return null===(e=this._trailerStream)||void 0===e?void 0:e.Size}get root(){var e;return null===(e=this._trailerStream)||void 0===e?void 0:e.Root}static parse(e){if(!e)return null;const t=lt.parse(e);if(!t)return null;return{value:new ht(t.value),start:null,end:null}}getEntries(){if(!this._trailerStream)return[];let e;if(this._trailerStream.DecodeParms){const t=this._trailerStream.DecodeParms;e=Ge.Decode(this._trailerStream.streamData,t.Predictor,t.Columns,t.Colors,t.BitsPerComponent)}else e=Ge.Decode(this._trailerStream.streamData);return ct.parseFromStream(e,this._trailerStream.W,this._trailerStream.Index)}}class ut extends et{constructor(){super(Re)}static parse(e){const t=new ut;return t.tryParseProps(e)?{value:t,start:e.bounds.start,end:e.bounds.end}:null}tryParseProps(e){if(!super.tryParseProps(e))return!1;const{parser:t,bounds:n}=e,r=n.contentStart||n.start,i=n.contentEnd||n.end;let s,a,o=t.skipToNextName(r,i-1);if(-1===o)return!1;for(;a=t.parseNameAt(o),a;)switch(o=a.end+1,s=a.value,s){case"/Size":const e=t.parseNumberAt(o,!1);if(!e)throw new Error("Can't parse /Size property value");this.Size=e.value,o=e.end+1;break;case"/Prev":const n=t.parseNumberAt(o,!1);if(!n)throw new Error("Can't parse /Size property value");this.Prev=n.value,o=n.end+1;break;case"/Root":const r=Ke.parseRef(t,o);if(!r)throw new Error("Can't parse /Root property value");this.Root=r.value,o=r.end+1;break;case"/Encrypt":const s=Ke.parseRef(t,o);if(!s)throw new Error("Can't parse /Encrypt property value");this.Encrypt=s.value,o=s.end+1;break;case"/Info":const a=Ke.parseRef(t,o);if(!a)throw new Error("Can't parse /Info property value");this.Info=a.value,o=a.end+1;break;default:o=t.skipToNextName(o,i-1)}return!(isNaN(this.Size)||!this.Root)}}class pt extends dt{constructor(e,t){super(ge),this._table=e,this._trailerDict=t}get prev(){var e;return null===(e=this._trailerDict)||void 0===e?void 0:e.Prev}get size(){var e;return null===(e=this._trailerDict)||void 0===e?void 0:e.Size}get root(){var e;return null===(e=this._trailerDict)||void 0===e?void 0:e.Root}static parse(e,t){if(!e||isNaN(t))return null;const n=e.getXrefTableBoundsAt(t);if(!n)return null;const r=e.getDictBoundsAt(n.end+1);if(!r)return null;const i=e.sliceCharCodes(n.contentStart,n.contentEnd),s=ut.parse({parser:e,bounds:r});if(!s)return null;return{value:new pt(i,s.value),start:null,end:null}}getEntries(){if(!this._table.length)return[];return ct.parseFromTable(this._table)}}class ft{constructor(e){var t;const n={objectId:0,generation:65535,nextId:0},r=n,i=new Map,s=new Map([[0,n]]);let a,o,l=!1;for(const t of e){if(t.type!==we)continue;l||0!==t.objectId||(l=!0,n.nextId=t.nextFreeId);const e=s.get(t.objectId);(!e||e.generation<t.generation)&&s.set(t.objectId,{objectId:t.objectId,generation:t.generation,nextId:t.nextFreeId})}let d=n;for(;a=d.nextId,o=s.get(a),s.delete(a),d.next=o,a;)d=o;[...s].forEach((e=>{const t=e[1];65535===t.generation&&0===t.nextId&&i.set(t.objectId,t)})),this.freeLinkedList=r,this.freeOutsideListMap=i;const c=new Map;for(const t of e){if(t.type!==ve||!this.checkReference(t))continue;const e=c.get(t.objectId);e&&e.generation>=t.generation||c.set(t.objectId,{objectId:t.objectId,generation:t.generation,byteOffset:t.byteOffset})}for(const n of e){if(n.type!==me||!this.checkReference(n))continue;if(c.get(n.objectId))continue;const e=null===(t=c.get(n.streamId))||void 0===t?void 0:t.byteOffset;e&&c.set(n.objectId,{objectId:n.objectId,generation:n.generation,byteOffset:e})}this.usedMap=c}checkReference(e){if(this.freeOutsideListMap.has(e.objectId))return!1;let t=this.freeLinkedList;for(;t.nextId;){if(e.objectId===t.objectId&&e.generation<t.generation)return!1;t=t.next}return!0}getOffset(e){var t;return null===(t=this.usedMap.get(e))||void 0===t?void 0:t.byteOffset}}class gt{constructor(e){this._docParser=new ze(e),this._version=this._docParser.getPdfVersion();const t=this._docParser.getLastXrefIndex();if(!t)throw new Error("File doesn't contain update section");this._lastXrefIndex=t.value}get size(){var e;return(null===(e=this._xrefs)||void 0===e?void 0:e.length)?this._xrefs[0].prev:0}parse(){this.reset();const e=this.parseAllXrefs();if(!e.length)throw new Error("Failed to parse cross-reference sections");const t=[];if(e.forEach((e=>t.push(...e.getEntries()))),!t.length)throw new Error("No indirect object references found");this._xrefs=e,this._referenceData=new ft(t),console.log(this._xrefs),console.log(this._referenceData),this.parsePageTree(),console.log(this._catalog),console.log(this._pageRoot),console.log(this._pages);const n=[];for(const e of this._pages){if(!e.Annots)return;Array.isArray(e.Annots)&&n.push(...e.Annots)}}reset(){this._xrefs=null,this._referenceData=null}parseAllXrefs(){this.reset();const e=[];let t,n=this._lastXrefIndex,r=this._docParser.maxIndex;for(;n&&(t=this.parsePrevXref(n,r),t);)e.push(t),r=n,n=t.prev;return e}parsePrevXref(e,t){if(!e)return null;const n=this._docParser.findSubarrayIndex(ae.XREF_TABLE,{minIndex:e,closedOnly:!0});if(n&&n.start===e){const n=this._docParser.findSubarrayIndex(ae.XREF_HYBRID,{minIndex:e,maxIndex:t,closedOnly:!0});if(!n){console.log("XRef is table");const t=pt.parse(this._docParser,e);return null==t?void 0:t.value}{console.log("XRef is hybrid");const t=this._docParser.parseNumberAt(n.end+1);if(!t)return null;e=t.value}}else console.log("XRef is stream");const r=Ke.parse(this._docParser,e,!1);if(!r)return null;const i=this._docParser.getIndirectObjectBoundsAt(r.end+1);if(!i)return null;const s=ht.parse({parser:this._docParser,bounds:i});return null==s?void 0:s.value}parsePageTree(){const e=this._xrefs[0].root,t=this.getObjectParseInfo(e.id),n=it.parse(t);if(!n)throw new Error("Document root catalog not found");this._catalog=n.value;const r=n.value.Pages,i=this.getObjectParseInfo(r.id),s=ot.parse(i);if(!s)throw new Error("Document root page tree not found");this._pageRoot=s.value;const a=[];this.parsePages(a,s.value),this._pages=a}parsePages(e,t){if(t.Kids.length)for(const n of t.Kids){const t=this.getObjectParseInfo(n.id);if(!t)continue;const r=t.parser.parseDictType(t.bounds);if(r===Ne){const n=ot.parse(t);n&&this.parsePages(e,n.value)}else if(r===Te){const n=at.parse(t);n&&e.push(n.value)}}}getObjectParseInfo(e){var t;if(!e)return null;const n=null===(t=this._referenceData)||void 0===t?void 0:t.getOffset(e);if(isNaN(n))return null;const r=Ke.parse(this._docParser,n);if(!r)return null;const i=this._docParser.getIndirectObjectBoundsAt(r.end+1,!0);if(!i)return null;const s={parser:this._docParser,bounds:i};if(r.value.id===e)return s;const a=rt.parse(s);if(!a)return;const o=a.value.getObjectData(e);return o||null}}class At{constructor(e){if(this.onAnnotationDictChange={set:(e,t,n)=>!0},!(null==e?void 0:e.length))throw new Error("Data is empty");this._sourceData=e,this._documentData=new gt(e),this._documentData.parse()}get annotations(){return this._annotations.map((e=>new Proxy(e,this.onAnnotationDictChange)))}getRefinedData(){return null}getExportedData(){return null}addAnnotationDict(e){this._annotations.push(e)}updateData(){}extractSupportedAnnotationDicts(){}}var wt=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{l(r.next(e))}catch(e){s(e)}}function o(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};class vt{constructor(e,t){this._visibleAdjPages=0,this._previewWidth=100,this._minScale=.25,this._maxScale=4,this._scale=1,this._previewerHidden=!0,this._pages=[],this._currentPage=0,this._mode="normal",this._pointerInfo={lastPos:null,downPos:null,downScroll:null},this._timers={hidePanels:0},this._pinchInfo={active:!1,lastDist:0,minDist:10,sensitivity:.025,target:null},this.onPdfLoadingProgress=e=>{},this.onPdfLoadedAsync=e=>wt(this,void 0,void 0,(function*(){this._pdfDocument=e,yield this.refreshPagesAsync(),this.renderVisiblePreviews(),this.renderVisiblePages(),this._shadowRoot.querySelector("#panel-bottom").classList.remove("disabled")})),this.onPdfClosedAsync=()=>wt(this,void 0,void 0,(function*(){this._shadowRoot.querySelector("#panel-bottom").classList.add("disabled"),this._pdfDocument&&(this._pdfDocument=null),yield this.refreshPagesAsync()})),this.onMainContainerResize=(e,t)=>{const{width:n}=this._mainContainer.getBoundingClientRect();n<721?this._mainContainer.classList.add("mobile"):this._mainContainer.classList.remove("mobile")},this.onHandToggleClick=()=>{"hand"===this._mode?(this._mode="normal",this._viewer.classList.remove("hand"),this._shadowRoot.querySelector("div#toggle-hand").classList.remove("on")):(this._mode="hand",this._viewer.classList.add("hand"),this._shadowRoot.querySelector("div#toggle-hand").classList.add("on"))},this.onPreviewerToggleClick=()=>{this._previewerHidden?(this._mainContainer.classList.remove("hide-previewer"),this._shadowRoot.querySelector("div#toggle-previewer").classList.add("on"),this._previewerHidden=!1,setTimeout((()=>this.renderVisiblePreviews()),1e3)):(this._mainContainer.classList.add("hide-previewer"),this._shadowRoot.querySelector("div#toggle-previewer").classList.remove("on"),this._previewerHidden=!0)},this.onPreviewerPageClick=e=>{let t,n=e.target;for(;n&&!t;){const e=n.dataset.pageNumber;e?t=+e:n=n.parentElement}t&&this.scrollToPage(t-1)},this.onPreviewerScroll=e=>{this.renderVisiblePreviews()},this.onPaginatorInput=e=>{e.target instanceof HTMLInputElement&&(e.target.value=e.target.value.replace(/[^\d]+/g,""))},this.onPaginatorChange=e=>{if(e.target instanceof HTMLInputElement){const t=Math.max(Math.min(+e.target.value,this._pdfDocument.numPages),1);t+""!==e.target.value&&(e.target.value=t+""),this.scrollToPage(t-1)}},this.onPaginatorPrevClick=()=>{const e=i(this._currentPage-1,0,this._pages.length-1);this.scrollToPage(e)},this.onPaginatorNextClick=()=>{const e=i(this._currentPage+1,0,this._pages.length-1);this.scrollToPage(e)},this.onZoomOutClick=()=>{this.zoomOut()},this.onZoomInClick=()=>{this.zoomIn()},this.onZoomFitViewerClick=()=>{const e=i((this._viewer.getBoundingClientRect().width-20)/this._pages[this._currentPage].viewContainer.getBoundingClientRect().width*this._scale,this._minScale,this._maxScale);this.setScale(e),this.scrollToPage(this._currentPage)},this.onZoomFitPageClick=()=>{const{width:e,height:t}=this._viewer.getBoundingClientRect(),{width:n,height:r}=this._pages[this._currentPage].viewContainer.getBoundingClientRect(),s=i((e-20)/n*this._scale,this._minScale,this._maxScale),a=i((t-20)/r*this._scale,this._minScale,this._maxScale);this.setScale(Math.min(s,a)),this.scrollToPage(this._currentPage)},this.onViewerScroll=e=>{this.renderVisiblePages()},this.onViewerPointerMove=e=>{const{clientX:t,clientY:n}=e,{x:r,y:i,width:s,height:a}=this._viewer.getBoundingClientRect(),o=t-r,l=n-i,d=s-o,c=a-l;Math.min(o,d,l,c)>100?this._panelsHidden||this._timers.hidePanels||(this._timers.hidePanels=setTimeout((()=>{this._mainContainer.classList.add("hide-panels"),this._panelsHidden=!0,this._timers.hidePanels=null}),5e3)):(this._timers.hidePanels&&(clearTimeout(this._timers.hidePanels),this._timers.hidePanels=null),this._panelsHidden&&(this._mainContainer.classList.remove("hide-panels"),this._panelsHidden=!1)),this._pointerInfo.lastPos={x:t,y:n}},this.onViewerPointerDown=e=>{if("hand"!==this._mode)return;const{clientX:t,clientY:n}=e;this._pointerInfo.downPos={x:t,y:n},this._pointerInfo.downScroll={x:this._viewer.scrollLeft,y:this._viewer.scrollTop};const r=e=>{const{x:t,y:n}=this._pointerInfo.downPos,{x:r,y:i}=this._pointerInfo.downScroll,s=e.clientX-t,a=e.clientY-n;this._viewer.scrollTo(r-s,i-a)},i=e=>{this._pointerInfo.downPos=null,this._pointerInfo.downScroll=null,window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",i),window.removeEventListener("pointerout",i)};window.addEventListener("pointermove",r),window.addEventListener("pointerup",i),window.addEventListener("pointerout",i)},this.onViewerTouchStart=e=>{if(2!==e.touches.length)return;const t=e.touches[0],n=e.touches[1];this._pinchInfo.active=!0,this._pinchInfo.lastDist=s(t.clientX,t.clientY,n.clientX,n.clientY);const r=e=>{if(2!==e.touches.length)return;const t=e.touches[0],n=e.touches[1],r=s(t.clientX,t.clientY,n.clientX,n.clientY),i=r-this._pinchInfo.lastDist,a=Math.floor(i/this._pinchInfo.minDist);if(a){const e=(o=t.clientX,l=t.clientY,d=n.clientX,c=n.clientY,{x:(d+o)/2,y:(c+l)/2});this._pinchInfo.lastDist=r,this.zoom(a*this._pinchInfo.sensitivity,e)}var o,l,d,c},i=t=>{this._pinchInfo.active=!1,this._pinchInfo.lastDist=0,e.target.removeEventListener("touchmove",r),e.target.removeEventListener("touchend",i),e.target.removeEventListener("touchcancel",i)};e.target.addEventListener("touchmove",r),e.target.addEventListener("touchend",i),e.target.addEventListener("touchcancel",i)},this.onViewerWheel=e=>{e.ctrlKey&&(e.preventDefault(),e.deltaY>0?this.zoomOut(this._pointerInfo.lastPos):this.zoomIn(this._pointerInfo.lastPos))};const r=document.querySelector(e);if(!r)throw new Error("Container not found");if(!(r instanceof HTMLDivElement))throw new Error("Container is not a DIV element");if(this._outerContainer=r,!t)throw new Error("Worker source path not defined");n.workerSrc=t,this.initViewerGUI()}destroy(){var e,t;null===(e=this._pdfLoadingTask)||void 0===e||e.destroy(),this._pages.forEach((e=>e.destroy())),this._pdfDocument&&(this._pdfDocument.cleanup(),this._pdfDocument.destroy()),null===(t=this._mainContainerResizeObserver)||void 0===t||t.disconnect(),this._shadowRoot.innerHTML=""}openPdfAsync(e){return wt(this,void 0,void 0,(function*(){let t,n;try{if(e instanceof Uint8Array)t=e;else{let n;if("string"==typeof e){const t=yield fetch(e);n=yield t.blob()}else n=e;const r=yield n.arrayBuffer();t=new Uint8Array(r)}}catch(e){throw new Error("Cannot load file data!")}new At(t);try{if(this._pdfLoadingTask)return yield this.closePdfAsync(),this.openPdfAsync(t);this._pdfLoadingTask=r(t),this._pdfLoadingTask.onProgress=this.onPdfLoadingProgress,n=yield this._pdfLoadingTask.promise,this._pdfLoadingTask=null}catch(e){throw new Error("Cannot open PDF!")}yield this.onPdfLoadedAsync(n)}))}closePdfAsync(){return wt(this,void 0,void 0,(function*(){this._pdfLoadingTask&&(this._pdfLoadingTask.destroyed||(yield this._pdfLoadingTask.destroy()),this._pdfLoadingTask=null),yield this.onPdfClosedAsync()}))}initViewerGUI(){this._shadowRoot=this._outerContainer.attachShadow({mode:"open"}),this._shadowRoot.innerHTML='\n  <style>\n    :host {\n      --color-primary-final: var(--color-primary, rgba(40,40,40,1));\n      --color-primary-tr-final: var(--color-primary-tr, rgba(40,40,40,0.9));\n      --color-secondary-final: var(--color-secondary, rgba(60,60,60,1));\n      --color-secondary-tr-final: var(--color-secondary-tr, rgba(60,60,60,0.9));\n      --color-accent-final: var(--color-accent, rgba(96,96,96,1));\n      --color-shadow-final: var(--color-shadow, rgba(0,0,0,0.75));\n      --color-bg-final: var(--color-bg, rgba(128,128,128,1));\n      --color-fg-primary-final: var(--color-fg-primary, rgba(255,255,255,1));\n      --color-fg-secondary-final: var(--color-fg-secondary, rgba(187,187,187,1));\n      --color-fg-accent-final: var(--color-fg-accent, rgba(255,255,255,1));\n      --color-text-selection-final: var(--color-text-selection, rgba(104,104,128,0.3));\n    }\n\n    .disabled {\n      pointer-events: none;\n    }\n\n    .absolute {\n      position: absolute;\n    }\n    .abs-stretch {\n      position: absolute;\n      left: 0;\n      right: 0;\n      top: 0;\n      bottom: 0;\n    }\n    .abs-topleft {\n      position: absolute;\n      left: 0;\n      top: 0;\n    }\n\n    #main-container {\n      box-sizing: border-box;\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      justify-content: stretch;\n      align-items: stretch;\n      width: 100%;\n      height: 100%;\n      background: var(--color-bg-final);\n    }\n  \n    #panel-top {\n      position: relative;\n      display: flex;\n      flex-direction: row;\n      justify-content: space-between;\n      align-items: center;\n      flex-shrink: 0;\n      width: 100%;\n      height: 50px;\n      background: var(--color-primary-final);\n      box-shadow: 0 0 10px var(--color-shadow-final);\n      z-index: 1;\n      transition: height 0.25s ease-out 0.1s;\n    }\n    .hide-panels #panel-top {\n      height: 0;\n      transition: height 0.25s ease-in 0.2s;\n    }\n  \n    #panel-bottom {\n      position: absolute;\n      display: flex;\n      flex-direction: row;\n      justify-content: center;\n      align-items: center;\n      flex-grow: 0;\n      flex-shrink: 0;\n      left: calc(50% - 160px);\n      bottom: 20px;\n      width: 320px;\n      height: 50px;  \n      background: var(--color-primary-tr-final);\n      box-shadow: 0 0 10px var(--color-shadow-final);\n      z-index: 1;\n      transition: height 0.25s ease-out, bottom 0.1s linear 0.25s;\n    }\n    .hide-panels #panel-bottom {\n      bottom: 0;\n      height: 0;\n      transition: bottom 0.1s linear 0.1s, height 0.25s ease-in 0.2s;\n    }\n\n    .panel-v-separator {\n      width: 1px;\n      height: 30px;\n      background-color: var(--color-fg-secondary-final);\n    }\n  \n    .panel-button {\n      cursor: pointer;\n      user-select: none;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n      width: 36px;\n      height: 36px;\n      border-radius: 50%;\n    }\n    .panel-button:hover,\n    .panel-button.on {\n      background-color: var(--color-accent-final);\n    }\n    .panel-button img {\n      width: 20px;\n      height: 20px;\n      filter: invert() opacity(0.5) drop-shadow(0 0 0 var(--color-fg-primary-final)) saturate(1000%);\n    }  \n    .panel-button:hover img,\n    .panel-button.on img {\n      filter: invert() opacity(0.5) drop-shadow(0 0 0 var(--color-fg-accent-final)) saturate(1000%);\n    }  \n  \n    .subpanel {\n      display: flex;\n      flex-direction: row;\n      justify-content: center;\n      align-items: center;\n      margin: 0 4px;\n    }    \n    \n    .panel-item {\n      transform: scale(1);\n      transition: opacity 0.1s ease-out 0.35s, transform 0s linear 0.35s;\n    }\n    .hide-panels .panel-item {\n      cursor: default;      \n      opacity: 0;\n      transform: scale(0);\n      transition: opacity 0.1s ease-in, transform 0s linear 0.1s;\n    }\n  \n    #paginator {  \n      user-select: none;\n      font-family: sans-serif;\n      font-size: 16px;\n      color: var(--color-fg-primary-final);\n    }\n    #paginator-input {\n      text-align: center; \n      font-size: 16px;\n      width: 30px;\n      height: 30px;\n      margin: 2px;\n      padding: 0;\n      outline: none;\n      border: none;\n      color: var(--color-fg-primary-final);\n      background-color: var(--color-primary-final);\n    }\n    #paginator-total {\n      margin: 4px;\n    }\n\n    #toggle-previewer {\n      margin: 4px;\n    }\n      \n    #previewer {\n      box-sizing: border-box;\n      position: absolute;\n      display: flex;\n      flex-direction: column;\n      justify-content: flex-start;\n      overflow-y: auto;\n      left: 0;\n      top: 50px;\n      bottom: 0;\n      width: 160px; \n      padding-top: 0px;\n      background: var(--color-secondary-final);\n      box-shadow: 0 0 10px var(--color-shadow-final);\n      z-index: 1;\n      transition: padding-top 0.25s ease-out 0.1s, top 0.25s ease-out 0.1s, width 0.25s ease-out;\n    } \n    .hide-panels #previewer {\n      top: 0;\n      padding-top: 50px;\n      transition: padding-top 0.25s ease-in 0.2s, top 0.25s ease-in 0.2s;\n    }   \n    .mobile #previewer {\n      background: var(--color-secondary-tr-final);\n    } \n    .hide-previewer #previewer {\n      width: 0;\n      transition: width 0.25s ease-in 0.1s;\n    }\n    #previewer .page-preview {      \n      transform: scaleX(1);\n      transition: opacity 0.1s ease-out 0.35s, transform 0s linear 0.35s;\n    }\n    .hide-previewer #previewer .page-preview {\n      opacity: 0;\n      transform: scaleX(0);\n      transition: opacity 0.1s ease-in, transform 0s linear 0.1s;\n    }\n  \n    #viewer {\n      box-sizing: border-box;\n      position: absolute;\n      display: flex;\n      flex-direction: column;\n      justify-content: flex-start;\n      overflow: auto;\n      left: 160px;\n      right: 0;\n      top: 50px;\n      bottom: 0;\n      padding-top: 0px;\n      transition: padding-top 0.25s ease-out 0.1s, top 0.25s ease-out 0.1s, left 0.25s ease-out;\n    }\n    #viewer.hand {\n      cursor: grab !important;\n      user-select: none !important;\n    }\n    .hide-panels #viewer {\n      top: 0;\n      padding-top: 50px;\n      transition: padding-top 0.25s ease-in 0.2s, top 0.25s ease-in 0.2s;\n    }      \n    .hide-panels.mobile #viewer,\n    .hide-panels.hide-previewer #viewer {\n      top: 0;\n      padding-top: 50px;\n      left: 0;\n      transition: padding-top 0.25s ease-in 0.2s, top 0.25s ease-in 0.2s, left 0.25s ease-in;\n    }   \n    .mobile #viewer,\n    .hide-previewer #viewer {\n      top: 50px;\n      padding-top: 0px;\n      left: 0;\n      transition: padding-top 0.25s ease-out 0.1s, top 0.25s ease-out 0.1s, left 0.25s ease-in;\n    } \n  \n    .page {    \n      position: relative;\n      display: flex;\n      flex-grow: 0;\n      flex-shrink: 0;\n      margin: 10px auto;\n      background-color: white;\n      box-shadow: 0 0 10px var(--color-shadow-final);\n    }\n    .page-preview {   \n      cursor: pointer; \n      position: relative;\n      display: flex;\n      flex-grow: 0;\n      flex-shrink: 0;\n      margin: 0 auto;\n      background-color: white;\n      background-clip: content-box;\n      border-style: solid;\n      border-width: 10px 10px 20px 10px;\n      border-color: transparent;\n    }\n    .page-preview:hover,\n    .page-preview.current {\n      border-color: var(--color-accent-final);\n    }\n    .page-preview::after {\n      display: inline-block;\n      position: absolute;\n      top: calc(100% + 3px);\n      width: 100%;\n      text-align: center;\n      font-family: sans-serif;\n      font-size: 14px;\n      line-height: 1;\n      color: var(--color-fg-primary-final);\n      content: attr(data-page-number) " ";\n    }\n\n    .page-canvas {\n      background-color: white;\n    } \n    \n    .page-text {\n      position: absolute;\n      left: 0;\n      right: 0;\n      top: 0;\n      bottom: 0;\n      margin: 0;\n      padding: 0;\n      overflow: hidden;\n      line-height: 1;\n    }\n    .page-text span {\n      cursor: text;\n      position: absolute;\n      white-space: pre;\n      color: transparent;\n      transform-origin: 0% 0%;\n    }\n    .page-text ::selection {\n      background: var(--color-text-selection-final);\n    }\n    .hand .page-text span {\n      cursor: grab;\n    }\n  </style>\n\n  <div id="main-container" class="hide-previewer">\n    <div id="viewer"></div>\n    <div id="previewer"></div>\n    <div id="panel-top"> \n      <div class="subpanel panel-item">\n        <div id="toggle-previewer" class="panel-button panel-item">\n          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABcmlDQ1BpY2MAACiRdZE9S8NQFIbftkpFWwrqIOKQoYpCC0VBHKWCXapDW8GqS3KbtEKShpsUKa6Ci0PBQXTxa/Af6Cq4KgiCIoi4+Af8WqTEc5tCi7Qn3JyH9573cO+5gD+tM8PuSQCG6fBMKimt5tek4Dt8GEQYQ5iSmW0tZRdz6Bo/j1RN8RAXvbrXdYyBgmozwNdHPMss7hDPE6e3HEvwHvEwK8kF4hPiGKcDEt8KXfH4TXDR4y/BPJdZAPyip1RsY6WNWYkbxJPEUUOvsOZ5xE1CqrmSpTxKaww2MkghCQkKKtiEDgdxyibNrLMv0fAto0weRn8LVXByFFEib4zUCnVVKWukq/TpqIq5/5+nrc1Me91DSaD31XU/x4HgPlCvue7vqevWz4DAC3BttvxlmtPcN+m1lhY9BiI7wOVNS1MOgKtdYOTZkrnckAK0/JoGfFwA4TwwdA/0r3uzau7j/AnIbdMT3QGHR8AE1Uc2/gDt82gCvNGYhAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAcpJREFUeNrtWwFuwyAMjBEPWNf8/4XpugesoWMKUppBYidQ5cAnVZWaRtGdDxscoC6Bvu9d7PfRue6sMETJa8MwRC8Slzi6ACkhiEu8FgGWQpiucdBW9FNj5wiWzyvxjOk5/muVm30n8Xfjl8NfkNeEMLHo10Cem/CbyAHeCZMb/sGePfqTfXfh5/Hovu/3F25Lx9ujiURad6WIld1xHDtjTLLshXv8f7Zgka2dY04ClQNCxDmR5eL0Dvi63Vavf16vh1xjzzy13YKUPPQQWFaDHOShBJjX8VzkIRdDa+RDvvBlskoBOOSlVcLURr7KIVCKPIQAJclDJsGc5FkzwdBUqJE8pANykocTIDd59mKI2zIv0Q8oSR7GAaXIQwhQkjx0GVQBGI5xjEWRrTGqkmGjQ0AFUAFUABVABVAB2sXmRMi3pEbnSDLJyNm3h3MAEvnsAqCRZw0Bb/l5Q2THjg1qaghoFVABVAAVQAVQAVQAFUCCI9thxYSJXj5WcspCHaACNNgP+LhcTr+gySqAX/nNX2nP99ujI/aaX3NAbAPDkQ0RSNFfPTUWbkA/QLUVTNoT9RpOj+rJ0aUDJE5AdkDy8LRECEQBUrnsCeUexwK5uUFRAAAAAElFTkSuQmCC"/>\n        </div> \n        <div id="toggle-hand" class="panel-button panel-item">\n          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABcWlDQ1BpY2MAACiRdZE9S8NQFIbfpkpFqx3qIMUhQxWHFoqCOEoFu1SHtoJVl+Q2aYQkDUmKFFfBxaHgILr4NfgPdBVcFQRBEURc/AN+LVLiuU2hRdoTbs7De897uPdcQMjqzHD6UoBhunYukxZXi2ti6B0BxDACAVGJOdZSfrGAnvHzSNUUD0neq3dd1xgqKQ4DAgPEs8yyXeJ54uyWa3HeIx5lmlQiPiFO2HRA4luuyz6/cS77/MXZLuQWAIH3FMsdLHcw02yDeIo4buhV1joPv0lYMVfylGO0xuEghwzSECGjik3ocJGkbNLMuvtSTd8yKuRh9LdQg02OMjTyJkitUleFskq6Qp+OGp/7/3k66sy03z2cBvpfPe9zAgjtA4265/2eel7jDAi+ANdm21+hOc19k15va/FjILIDXN60NfkAuNoFxp4tyZaaUpCWoKrAxwUwXASi98Dguj+r1j7On4DCNj3RHXB4BExSfWTjD603Z+Sp2ztrAAAACXBIWXMAAAsTAAALEwEAmpwYAAADGklEQVR42uVbC47jIAytESeY6f1P2NkjLCOqInmoP5g4BChSpLZJAT8/G9sQuDHtfr+Tv/9P6WZp/35+tP6lDsEyXgBg7z0eD3qAVsE9AWgU/s8cOQG+vr+bAOCAiK2Cn9CS4TnwGrTIWYAItw9voGmfo56DJlI1DnD38jx75qGxOvcZRwuuCV++V888zaCmLyUkvlc+S0BE6uZBtBMDKHjYbvnMzVG6Rz0bvbSaByWo+0frR0GQWCSZicSE0Kv93Fm5mAl10V/4PSkrSGpRkgrAUXoatWbq8yVA8ujfFQBOg56UbxXQCoIXACytvUHwBjkepffL+Q0PYGqQseaxw5WWyScDcmyPr6uEYOzdnT3YcTcxwMsBtsTlXv1aVoJwpv0bNH16tDl8FThTmwygXeYSBtn61YAmLn6YlgFW0Bg/UgueatMYWQ+AWRiFQZjSBOql6kwneWlF6MyaA8E+6EqHtUleEQUeMD2ofcJH1QRPS4cno7tp/NjoMGbSIljpL4EfPo3ybwzAOzd5aRC0DSOTllEgBEPykBSAlmzBkjkhILyWJLb2Vy7qP54heW89oGu/rgiEKskiRdGETyurBUr7L08L0sA9FdhpTYBaZopmpMKjBwjO+5KiuVD9xVYPSuzXTRdAtdQRc90TnyMIBxBetuHib+jQxjYgPNnQ68m3igOsjm0nEALl4Q2BzvIgRC3Qwaewciu5A9pzr4sM65nAQRYszYioxPzqQUXsDzJbOMZMDwAX6GQB6vM522WDStKzdYt1HlCzQNrBXZEROAxuDYS2YUGtrAwGmw1+SmsNhdMm2n87Wxha1/PdvH/xa8GQg69eEL3ufMBszg+zPBjD2jRwgmfavv7CxC7rvqbcgA89E4cKYQNfkCTlDt0XmGDZezNt1QmuGBgJwvNvjeE/t5Siy3ncq/f9LcJTrA1Wp7GAQ2SFJ0+ItGx5C0XQNJPmhYIuiG+Otm5P9QzQypwjpmSlPR4TNDoTr6iRA40+ak/l95QD1+RaemdIE96UDqMDCUuBYBW+lhM0O1VC4nQl/SkW1MJrcvwCJhH28gf87HUAAAAASUVORK5CYII="/>\n        </div> \n      </div>\n      <div id="annotator" class="subpanel panel-item">\n      </div>\n    </div>\n    <div id="panel-bottom" class="disabled">\n      <div id="paginator" class="subpanel panel-item">\n        <div id="paginator-prev" class="panel-button">\n          <img src="data:image/png;base64,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"/>\n        </div>\n        <div id="paginator-next" class="panel-button">\n          <img src="data:image/png;base64,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"/>\n        </div>\n        <input id="paginator-input" type="text">\n        <span>&nbsp/&nbsp</span>\n        <span id="paginator-total">0</span>\n      </div>\n      <div class="panel-v-separator panel-item"></div>\n      <div id="zoomer" class="subpanel panel-item">\n        <div id="zoom-out" class="panel-button">\n          <img src="data:image/png;base64,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"/>\n        </div>\n        <div id="zoom-in" class="panel-button">\n          <img src="data:image/png;base64,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"/>\n        </div>\n        <div id="zoom-fit-viewer" class="panel-button">\n          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABcWlDQ1BpY2MAACiRdZG9S8NQFMVPW8Wi1Q46SHHIUMWhhaIgjlLBLtWhrWDVJXlN2kKShpcUKa6Ci0PBQXTxa/A/0FVwVRAERRBx8R/wa5ES72sKLdLe8PJ+nHfP5eUE8Kd1Zth9CcAwHZ5JJaW1/Lo08A4fRhBEHBGZ2dZydimHnvXzSN1UD3Exq3df1xoqqDYDfEHiOWZxh3iBOL3lWIL3iMdYSS4QnxDHOF2Q+Fboisdvgosefwnmucwi4BczpWIHKx3MStwgniaOGnqVte4jviSkmqtZ2iO0JmAjgxSSkKCgijJ0OJRLGSZl1t2XaPpWUCEPo7eFGjg5iiiRN0ZqlaaqtGukq/ToqInc/+dpa7Mz3vRQEuh/dd3PSWBgH2jUXff31HUbZ0DgBbg22/4K5TT/TXq9rUWPgfAOcHnT1pQD4GoXGH+2ZC43pQAtv6YBHxfAcB4YvQcGN7ysWuc4fwJy2/SL7oDDI2CK+sObf/JNaAQfxWcoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+0lEQVR42u2bMW/EIAyFA7qla5Ol///HdUm6dguFKlQuBwnh7ADKs5TlTsrxPp6NAZ16H0czCMTXsijO90mNUw83DwC4OwAV5hZ37rYWoV6kAAAAAAAAAAAAAAAAAAAAAADcMh6CO63F7iwnkR2cUmqe57YcEIq3zyg4cWaapnYARM7rRjtLYupXY9ggaAHxzqKDtSgbAXdIkwBqqgK4QryP8J3OBe6xLjBVAFwpnjoh9rmDUJoOuhfxqXTwTiitCbon8WE6ROrCaQi6N/GxdFjX9XtzwWkIukS8/cHPmuKfnKD1W6kTdMnM2x/8qC0+VhNIPciGoEts7+nb75ro53cm4nCJ3L0ZkrqRvWSXRwokBZR9M9SzeJoOR82SziHYe5C6kA/A2cZB8E/PsXfh+zgqLt4+DgIl2cotsivEdizJlD0aZ84ymOy/G5nd5FhyJukQwHby8td60jW3hULpxP8Wu605O+vQrEaIQqDtZ20nePG+OStJz+xW+MkJpP2s4QQqvmTmizZDUSdsg7jSCVzii7bDHkK4PF5VEzjFFx+IOAip/lsSArf4YgCxZkl6iZQQ/zKAVJ/AnQ5S4lkA0Jog3Msv3OK5HBBdHZjj300TZxvOdjcoCYHrjlHMAT0HAAAAAAAAAAAAAAAAAAAAANwzFP47jBQAgFvHDyRnPtj60cBDAAAAAElFTkSuQmCC"/>\n        </div>\n        <div id="zoom-fit-page" class="panel-button">\n          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABcWlDQ1BpY2MAACiRdZG9S8NQFMVPW8Wi1Q46SHHIUMWhhaIgjlLBLtWhrWDVJXlN2kKShpcUKa6Ci0PBQXTxa/A/0FVwVRAERRBx8R/wa5ES72sKLdLe8PJ+nHfP5eUE8Kd1Zth9CcAwHZ5JJaW1/Lo08A4fRhBEHBGZ2dZydimHnvXzSN1UD3Exq3df1xoqqDYDfEHiOWZxh3iBOL3lWIL3iMdYSS4QnxDHOF2Q+Fboisdvgosefwnmucwi4BczpWIHKx3MStwgniaOGnqVte4jviSkmqtZ2iO0JmAjgxSSkKCgijJ0OJRLGSZl1t2XaPpWUCEPo7eFGjg5iiiRN0ZqlaaqtGukq/ToqInc/+dpa7Mz3vRQEuh/dd3PSWBgH2jUXff31HUbZ0DgBbg22/4K5TT/TXq9rUWPgfAOcHnT1pQD4GoXGH+2ZC43pQAtv6YBHxfAcB4YvQcGN7ysWuc4fwJy2/SL7oDDI2CK+sObf/JNaAQfxWcoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB30lEQVR42u2bzXKDIBCAw+ql6cnqpQ/Q93+f9gF60aan9GKwmkqHsXZA5Wd3YWcyySFO+D4WCLKKU+R4qush5u/DKfHIAlIXIFIDXs45eQhkAYlHiaUhTdMMcvgZniDcTE397Xb9vFweKQgoFfwU+ue1kFJ+AcDDf6J+RQKcqWRAv+cikyhqc4Ax71WPT73Pbg746Lpd/0uO7iVIrwIuNlJkBIyrhJddJBkBbdt62UIDp7Qf5xExL5PvLAXYwM+rxDM7AbbwLIeAL3gSAnzCoxfgGx61gBDwaAWEgkcpICQ8OgGh4VEJiAGPRkAseBQCPMF3JAQo+LV7e3vh9esGKd9M3xeppT2Kk6GYY/5PBiwb47sBmOCDZwA2eCsBVVW9Tg0fX63TsadNfLHgrQQIgBebHtza8+pQIyb81iFQc0n7YHMAdnivAijAexNABd6LAErwzgVQg3cqgCK8MwFU4Z0IoAx/WAB1+EMCOMBvEqAfOXOB3yRAHTlzgne6DOrwy3IW9gKWPa+Xs7AXQDHt9ThcJ7h2p8eiglPMdYF85oCpfvf+ble+OpDMAFNx8o7f7tELGHv2WhbF2SQGisJYv7soh+9JZICp3p565EdmsoDEQ8R+dpfSwUgeAlkAw/gGgdL3j4c6UpkAAAAASUVORK5CYII="/>\n        </div>\n      </div>\n    </div>\n  </div>\n';const e=this._shadowRoot.getElementById("paginator-input");e.addEventListener("input",this.onPaginatorInput),e.addEventListener("change",this.onPaginatorChange),this._shadowRoot.querySelector("#paginator-prev").addEventListener("click",this.onPaginatorPrevClick),this._shadowRoot.querySelector("#paginator-next").addEventListener("click",this.onPaginatorNextClick),this._shadowRoot.querySelector("#zoom-out").addEventListener("click",this.onZoomOutClick),this._shadowRoot.querySelector("#zoom-in").addEventListener("click",this.onZoomInClick),this._shadowRoot.querySelector("#zoom-fit-viewer").addEventListener("click",this.onZoomFitViewerClick),this._shadowRoot.querySelector("#zoom-fit-page").addEventListener("click",this.onZoomFitPageClick),this._shadowRoot.querySelector("div#toggle-previewer").addEventListener("click",this.onPreviewerToggleClick),this._shadowRoot.querySelector("div#toggle-hand").addEventListener("click",this.onHandToggleClick),this._previewer=this._shadowRoot.querySelector("div#previewer"),this._previewer.addEventListener("scroll",this.onPreviewerScroll),this._viewer=this._shadowRoot.querySelector("div#viewer"),this._viewer.addEventListener("scroll",this.onViewerScroll),this._viewer.addEventListener("wheel",this.onViewerWheel),this._viewer.addEventListener("pointermove",this.onViewerPointerMove),this._viewer.addEventListener("pointerdown",this.onViewerPointerDown),this._viewer.addEventListener("touchstart",this.onViewerTouchStart),this._mainContainer=this._shadowRoot.querySelector("div#main-container");const t=new ResizeObserver(this.onMainContainerResize);t.observe(this._mainContainer),this._mainContainerResizeObserver=t}refreshPagesAsync(){var e;return wt(this,void 0,void 0,(function*(){this._pages.forEach((e=>{e.previewContainer.removeEventListener("click",this.onPreviewerPageClick),e.destroy()})),this._pages.length=0;const t=(null===(e=this._pdfDocument)||void 0===e?void 0:e.numPages)||0;if(this._shadowRoot.getElementById("paginator-total").innerHTML=t+"",t)for(let e=0;e<t;e++){const t=yield this._pdfDocument.getPage(e+1),n=new c(t,this._maxScale,this._previewWidth);n.scale=this._scale,n.previewContainer.addEventListener("click",this.onPreviewerPageClick),this._previewer.append(n.previewContainer),this._viewer.append(n.viewContainer),this._pages.push(n)}}))}renderVisiblePreviews(){if(this._previewerHidden)return;const e=this._pages,t=this.getVisiblePages(this._previewer,e,!0),n=Math.max(Math.min(...t)-this._visibleAdjPages,0),r=Math.min(Math.max(...t)+this._visibleAdjPages,e.length-1);for(let t=0;t<e.length;t++){const i=e[t];t>=n&&t<=r&&i.renderPreviewAsync()}}renderVisiblePages(){var e,t;const n=this._pages,r=this.getVisiblePages(this._viewer,n),i=this._currentPage,s=this.getCurrentPage(this._viewer,n,r);if(i&&i===s||(null===(e=n[i])||void 0===e||e.previewContainer.classList.remove("current"),null===(t=n[s])||void 0===t||t.previewContainer.classList.add("current"),this._shadowRoot.getElementById("paginator-input").value=s+1+"",this.scrollToPreview(s),this._currentPage=s),-1===s)return;const a=Math.max(Math.min(...r)-this._visibleAdjPages,0),o=Math.min(Math.max(...r)+this._visibleAdjPages,n.length-1);for(let e=0;e<n.length;e++){const t=n[e];e>=a&&e<=o?t.renderViewAsync():t.clearView()}}scrollToPreview(e){const{top:t,height:n}=this._previewer.getBoundingClientRect(),{top:r,height:i}=this._pages[e].previewContainer.getBoundingClientRect(),s=r+i/2-(t+n/2)+this._previewer.scrollTop;this._previewer.scrollTo(0,s)}scrollToPage(e){const{top:t}=this._viewer.getBoundingClientRect(),{top:n}=this._pages[e].viewContainer.getBoundingClientRect(),r=n-(t-this._viewer.scrollTop);this._viewer.scrollTo(this._viewer.scrollLeft,r)}setScale(e,t=null){if(!e||e===this._scale)return;let n,r,i;if(t)for(const e of this._pages){const{x:s,y:a}=t,{x:o,y:l,width:d,height:c}=e.viewContainer.getBoundingClientRect();if(o<=s&&o+d>=s&&l<=a&&l+c>=a){n=e.viewContainer,r=(s-o)/d,i=(a-l)/c;break}}if(this._scale=e,this._pages.forEach((e=>e.scale=this._scale)),n&&(this._viewer.scrollHeight>this._viewer.clientHeight||this._viewer.scrollWidth>this._viewer.clientWidth)){const{x:e,y:s}=t,{x:a,y:o,width:l,height:d}=n.getBoundingClientRect(),c=a+l*r,h=o+d*i;let u=this._viewer.scrollLeft+(c-e),p=this._viewer.scrollTop+(h-s);if(u=u<0?0:u,p=p<0?0:p,p!==this._viewer.scrollTop||u!==this._viewer.scrollLeft)return void this._viewer.scrollTo(u,p)}setTimeout((()=>this.renderVisiblePages()),0)}zoom(e,t=null){const n=i(this._scale+e,this._minScale,this._maxScale);this.setScale(n,t||this.getViewerCenterPosition())}zoomOut(e=null){this.zoom(-.25,e)}zoomIn(e=null){this.zoom(.25,e)}getViewerCenterPosition(){const{x:e,y:t,width:n,height:r}=this._viewer.getBoundingClientRect();return{x:e+n/2,y:t+r/2}}getVisiblePages(e,t,n=!1){const r=new Set;if(!t.length)return r;const i=e.getBoundingClientRect(),s=i.top,a=i.top+i.height;for(let e=0;e<t.length;e++){const i=t[e],o=n?i.previewContainer.getBoundingClientRect():i.viewContainer.getBoundingClientRect(),l=o.top,d=o.top+o.height;if(l<a&&d>s)r.add(e);else if(r.size)break}return r}getCurrentPage(e,t,n){const r=[...n];if(!r.length)return-1;if(1===r.length)return r[0];const i=e.getBoundingClientRect(),s=i.top,a=i.top+i.height/2;for(const e of r){const n=t[e].viewContainer.getBoundingClientRect().top;if(n>s)return n>a?e-1:e}throw new Error("Incorrect argument")}}export{vt as TsPdfViewer};
